version: 2

models:
  - name: employee_department
    description: "Model joining employees with their department names using two CTEs."
    columns:
      - name: employee_id
        description: "Unique identifier for the employee"
        tests:
          - not_null
          - unique

      - name: department_name
        description: "Name of the department the employee belongs to"
        tests:
          - not_null
          - accepted_values:
              values: ['Development', 'Deployment', 'Human Resources' , 'Testing']

      - name: department_id
        description: "ID of the department"
        tests:
          - relationships:
              to: ref('department_cte')  
              field: department_id
